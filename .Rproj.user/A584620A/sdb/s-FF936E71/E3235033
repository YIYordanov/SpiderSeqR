{
    "collab_server" : "",
    "contents" : "## ----citation------------------------------------------------------------\ncitation(\"GEOmetadb\")\n\n## ----include=FALSE-----------------------------------\nlibrary(knitr)\noptions(width=55)\nopts_chunk$set(cache=TRUE,message=FALSE,warning=FALSE)\n\n## ----------------------------------------------------\nlibrary(GEOmetadb)\n\n## ----------------------------------------------------\nif(!file.exists('GEOmetadb.sqlite')) getSQLiteFile()\n\n## ----------------------------------------------------\nfile.info('GEOmetadb.sqlite')\n\n## ----------------------------------------------------\ncon <- dbConnect(SQLite(),'GEOmetadb.sqlite')\ndbDisconnect(con)\n\n## ----------------------------------------------------\ncon <- dbConnect(SQLite(),'GEOmetadb.sqlite')\n\n## ----------------------------------------------------\ngeo_tables <- dbListTables(con)\ngeo_tables\n\n## ----------------------------------------------------\ndbListFields(con,'gse')\n\n## ----------------------------------------------------\ndbGetQuery(con,'PRAGMA TABLE_INFO(gpl)')\n\n## ----------------------------------------------------\nrs <- dbGetQuery(con,'select * from gse limit 5')\nrs[,1:7]\n\n## ----------------------------------------------------\nrs <- dbGetQuery(con,paste(\"select gse,title from gse where\",\n                           \"contributor like '%Sean%Davis%'\",sep=\" \"))\nrs\n\n## ----------------------------------------------------\nrs <- dbGetQuery(con,paste(\"select gsm,supplementary_file\",\n                           \"from gsm where gpl='GPL96'\",\n                           \"and supplementary_file like '%CEL.gz'\"))\ndim(rs)\n\n## ----------------------------------------------------\nrs <- dbGetQuery(con,paste(\"select gpl.bioc_package,gsm.gpl,\",\n                           \"gsm,gsm.supplementary_file\",\n                           \"from gsm join gpl on gsm.gpl=gpl.gpl\",\n                           \"where gpl.manufacturer='Affymetrix'\",\n                           \"and gsm.supplementary_file like '%CEL.gz' \"))\nrs[1:5,]\n\n## ----------------------------------------------------\ngetTableCounts <- function(tableName,conn) {\n  sql <- sprintf(\"select count(*) from %s\",tableName)\n  return(dbGetQuery(conn,sql)[1,1])\n}\ndo.call(rbind,sapply(geo_tables,getTableCounts,con,simplify=FALSE))\n\n## ----------------------------------------------------\nconversion <- geoConvert('GPL96')\n\n## ----------------------------------------------------\nlapply(conversion, dim)\nconversion$gse[1:5,]\nconversion$gsm[1:5,]\nconversion$gds[1:5,]\nconversion$sMatrix[1:5,]\n\n## ----------------------------------------------------\ngetBiocPlatformMap(con, bioc=c('hgu133a','hgu95av2'))\n\n## ----------------------------------------------------\nsql <- paste(\"SELECT DISTINCT gse.title,gse.gse\",\n             \"FROM\",\n             \"  gsm JOIN gse_gsm ON gsm.gsm=gse_gsm.gsm\",\n             \"  JOIN gse ON gse_gsm.gse=gse.gse\",\n             \"  JOIN gse_gpl ON gse_gpl.gse=gse.gse\",\n             \"  JOIN gpl ON gse_gpl.gpl=gpl.gpl\",\n             \"WHERE\",\n             \"  gsm.molecule_ch1 like '%total RNA%' AND\",\n             \"  gse.title LIKE '%breast cancer%' AND\",\n             \"  gpl.organism LIKE '%Homo sapiens%'\",sep=\" \")\nrs <- dbGetQuery(con,sql)\ndim(rs)\nprint(rs[1:5,],right=FALSE)\n\n## ----fig.width=10------------------------------------\nlibrary(tm)\nlibrary(wordcloud)\ngseTitles = dbGetQuery(con,\"select title from gse\")\ncorp = VCorpus(VectorSource(gseTitles))\ncorp <- tm_map(corp, removePunctuation)\ncorp <- tm_map(corp, content_transformer(tolower))\ncorp <- tm_map(corp, removeNumbers)\ncorp <- tm_map(corp, function(x)removeWords(x,stopwords()))\nterm.matrix <- TermDocumentMatrix(corp)\nterm.matrix <- as.matrix(term.matrix)\nv <- sort(rowSums(term.matrix),decreasing=TRUE)\nd <- data.frame(word = names(v),freq=v)\nn = 100\nwordcloud(d[1:n,]$word,d[1:n,]$freq)\n\n## ----------------------------------------------------\nlibrary(dplyr)\ndb = src_sqlite('GEOmetadb.sqlite')\ngse = tbl(db,'gse')\nfilter(gse,gse=='GSE2553')\n\n## ----------------------------------------------------\ndbDisconnect(con)\n\n## ---- eval=FALSE-------------------------------------\n#  file.remove('GEOmetadb.sqlite')\n\n## ----------------------------------------------------\nsessionInfo()\n\n",
    "created" : 1505480643930.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3696424808",
    "id" : "E3235033",
    "lastKnownWriteTime" : 1505480638,
    "last_content_update" : 1505480638,
    "path" : "/tmp/mozilla_ss_lab0/GEOmetadb.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}