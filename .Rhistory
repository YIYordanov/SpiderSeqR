#Grepl GSE..., GSE... (...)
ss_match <- grepl("^GSE\\d\\d\\d+,GSE\\d\\d\\d+.*$", gse_list)
print(paste0(sum(ss_match), " out of ", length(gse_list), " entries belong to more than one GSE (some of them might be superseries)"))
if (sum(ss_match)>0){
#Get a list of GSEs that co-occur with other GSEs (i.e. GSEs from samples which have more than one GSEs)
ss_list <- unlist(strsplit(unique(gse_list[ss_match]), split=","))
ss_list <- unique(ss_list[order(ss_list)])
if (length(ss_list)!=0){
print(paste0("Consider carrying out superseries search on the following GSEs: ", paste(ss_list, collapse = ", ")))
}
return(ss_list)
} else {
return(NULL)
}
print("superseriesVerifier completed")
}
a <- superseriesVerifier("GSE75508")
a
is.null(a)
devtools::load_all()
searchForTerm(library_strategy = "RNA-Seq", treatment = "parkinson", species = "9606")
identical(readRDS("RNA_parkinso_9606_2_all_db_180223_172410.Rda"), readRDS("RNA_parkinso_9606_2_all_db_180223_165044.Rda"))
searchForTerm(library_strategy = "RNA-Seq", gene="fip37")
readRDS("RNA_fip37_2_ss_180223_173126.Rda")
View(viewSamples_db(readRDS("RNA_fip37_2_all_db_180223_173126.Rda")))
a <- superseriesVerifier("GSE75508")
a<- convertAccession("GSE75508")
superseriesVerifier(a$series_id)
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
convertAccession("GSE25933")
a
b
b <- c(2,5,3)
order(b)
b[order(b)]
devtools::test()
devtools::test()
?setequal
setequal(c(1,2,3,4,4,4,5), 1:5)
setequal(c("a", "b"), c("a", "a", "b"))
devtools::test()
searchForAccession("SRP026562")
devtools::test()
searchForAccession("SRP026562")
b <- searchForAccession("SRP026562")
View(b)
colnames(b)
devtools::test()
devtools::test()
devtools::test()
b <- searchForAccession("SRP026562")
View(b)
View(viewSamples_db(b))
searchForTerm(library_strategy = "RNA-Seq", tissue = "early stage_prefrontal cortex")
searchForTerm(library_strategy = "RNA-Seq", cell_type = "early stage_prefrontal cortex")
c <- searchForAccession("SRP058181")
View(c)
searchForTerm(library_strategy = "RNA-Seq", cell_type = "BA9 prefrontal cortex")
outputGenerator(c, st=list(library_strategy = "RNA-Seq", cell_type = "BA9"))
devtools::test()
outputGenerator(c, st=list(library_strategy = "RNA-Seq", cell_type = "BA9"))
filenameGenerator_acc(library_strategy = "RNA-Seq", accession = "SRP058181")
devtools::test()
filenameGenerator_acc(library_strategy = "RNA-Seq", accession = "SRP058181")
filenameGenerator_acc(library_strategy = "RNA-Seq", accession = "SRP058181", output = "sm", file = ".Rda")
devtools::test()
filenameGenerator_acc(library_strategy = "RNA-Seq", accession = "SRP058181", output = "sm", file = ".Rda")
filenameGenerator_acc(library_strategy = "RNA-Seq", accession = "SRP058181", output = "sm", file = "Rda")
devtools::test()
t1 <- filter(c, library_strategy = "RNA-Seq")
t1 <- filter(c, library_strategy == "RNA-Seq")
View(t1)
class(t1)
t1 <- filter(c, library_strategy %in% "RNA-Seq")
?%in%
%in%
??%in%
t1 <- filter(c, !(library_strategy %in% "RNA-Seq"))
View(SRP010068)
t2 <- filter(SRP010068, !(library_strategy %in% "RNA-Seq"))
dim(t2)
dim(t1)
dim(t1)[1]==0
arguments(filenameGenerator_acc())
devtools::test()
outputGenerator_acc(b, accession = "SRP026562" )
devtools::test()
outputGenerator_acc(b, accession = "SRP026562" )
colnames(b)
dbListFields(geo_con, "gsm")
temp <- dbGetQuery(geo_con, "SELECT * FROM gsm GROUP BY RANDOM () LIMIT 20")
View(temp)
devtools::test()
b <- searchForAccession("SRP026562")
View(b#)
q
View(b)
outputGenerator_acc(b, accession = "SRP026562" )
identical(readRDS("SRP026562_ALL_db_180226_161144.Rda"), readRDS("SRP026562_RNA_db_180226_161144.Rda"))
identical(readRDS("SRP026562_ALL_sm_180226_161144.Rda"), readRDS("SRP026562_RNA_sm_180226_161144.Rda"))
identical(readRDS("SRP026562_ALL_sm_180226_161144.Rda"), readRDS("/../../HDD/Anna/SpideR_Packaging201709/20180223_PD-AD/SRP026562/RNA_early st_2_all_sm_180226_121745.Rda"))
identical(readRDS("SRP026562_ALL_db_180226_161144.Rda"), readRDS("/../../HDD/Anna/SpideR_Packaging201709/20180223_PD-AD/SRP026562/RNA_early st_2_all_sm_180226_121745.Rda"))
identical(readRDS("SRP026562_ALL_db_180226_161144.Rda"), readRDS("/../../HDD/Anna/SpideR_Packaging201709/20180223_PD-AD/SRP026562/RNA_early st_2_all_db_180226_121745.Rda"))
dbListFields(geo_con, "gse")
grep("pubmed_id", b)
grep("pubmed_id", colnames(b))
View(c)
c2 <- searchForAccession("SRP058181")
View(viewSamples_db(c2))
devtools::test()
c2 <- searchForAccession("SRP058181")
View(viewSamples_db(c2))
identical(read.table("SRP058181_ALL_sm_180226_162548.csv"), read.table("/../../HDD/Anna/SpideR_Packaging201709/20180223_PD-AD/SRP058181/SRP058181_sm.csv"))
?read.table
identical(read.csv("SRP058181_ALL_sm_180226_162548.csv"), read.csv("/../../HDD/Anna/SpideR_Packaging201709/20180223_PD-AD/SRP058181/SRP058181_sm.csv"))
SRP010068b <- searchForAccession("SRP010068")
temp <- dbGetQuery(geo_con, "SELECT * FROM gsm WHRE gsm = 'gg'")
temp <- dbGetQuery(geo_con, "SELECT * FROM gsm WEHRE gsm = 'gg'")
temp <- dbGetQuery(geo_con, "SELECT * FROM gsm WHERE gsm = 'gg'")
dim(temp)
colnames(temp)
x1 <- data.frame(k = c(1,4), l = c(2,8), m = c(3, 12))
x1
y1 <- data.frame(m, n, o)
y1 <- data.frame()
colnames(y1) <- c("m", "n", "o")
y1 <- data.frame(m=NULL, n=NULL, o=NULL)
yq
y1
colnames(y1)
y1 <- data.frame(m=integer(0), n=integer(0), o=integer(0))
y1
merge(x1, y1, by.x1 = m, by.y1 = m, all = TRUE)
colnames(y1)
devtools::test()
SRP010068b <- searchForAccession("SRP010068")
devtools::test()
SRP010068b <- searchForAccession("SRP010068")
colnames(sra_df_temp)
colnames(srr_gsm_df_temp)
colnames(sra_srr_gsm_df_temp)
View(as.data.frame(sra_df_temp))
View(as.data.frame(colnames(sra_df_temp)))
View(as.data.frame(colnames(sra_srr_gsm_df_temp)))
View(sra_srr_gsm_df_temp)
View(sra_srr_gsm_df_temp)
View(geo_df_temp)
colnames(geo_df_temp)
dim(geo_df_temp)
y1b <- data.frame(m=character(0), n=character(0), o=character(0))
merge(x1, y1b, by.x1 = m, by.y1b = m, all = TRUE)
x1_y1b <- merge(x1, y1b, by.x1 = m, by.y1b = m, all = TRUE)
class(x1_y1b)
class(x1_y1b$n)
temp2 <- data.frame(rep(character(),5), stringsAsFactors = FALSE)
temp2
colnames(temp2)
temp2 <- data.frame(rep(integer(),5), stringsAsFactors = FALSE)
temp2
dim(temp2)
temp2 <- data.frame(rep(integer(),5))
dim(temp2)
temp2 <- df = data.frame(matrix(vector(), 0, 3,
dimnames=list(c(), c("Date", "File", "User"))),
stringsAsFactors=F)
temp2 <- data.frame(matrix(vector(), 0, 3,
dimnames=list(c(), c("Date", "File", "User"))),
stringsAsFactors=F)
temp2
dim(temp2)
colnames(temp2)
temp3 <- data.frame(matrix(vector(), 0, 3,
dimnames=list(c(), c("Date", "File", "User"))),
stringsAsFactors=F)
temp3
empt <- dbGetQuery(geo_con, "SELECT * FROM gsm WHERE gsm = 'gg")
empt <- dbGetQuery(geo_con, "SELECT * FROM gsm WHERE gsm = 'gg'")
empt
dim(empt)
devtools::test()
SRP010068c <- searchForAccession("SRP010068")
devtools::test()
SRP010068c <- searchForAccession("SRP010068")
devtools::test()
SRP010068c <- searchForAccession("SRP010068")
devtools::test()
SRP010068c <- searchForAccession("SRP010068")
devtools::load_all()
SRP010068c <- searchForAccession("SRP010068")
devtools::load_all()
SRP010068c <- searchForAccession("SRP010068")
View(geo_df_temp)
colnames(geo_df_temp)
View(sra_srr_gsm_df_temp)
View(sra_srr_gsm_geo_df_temp)
devtools::load_all()
SRP010068c <- searchForAccession("SRP010068")
View(sra_srr_gsm_df_temp)
View(sra_srr_gsm_geo_df_temp)
dim(sra_srr_gsm_geo_df_temp)
devtools::load_all()
SRP010068c <- searchForAccession("SRP010068")
devtools::load_all()
SRP010068c <- searchForAccession("SRP010068")
devtools::load_all()
SRP010068c <- searchForAccession("SRP010068")
devtools::load_all()
SRP010068c <- searchForAccession("SRP010068")
devtools::load_all()
SRP010068c <- searchForAccession("SRP010068")
rm(sra_df_temp)
rm(sra_srr_gsm_df_temp)
rm(sra_srr_gsm_geo_df_temp)
rm(geo_df_temp)
rm(srr_gsm_df_temp)
View(geo_df)
rm(geo_df)
rm(gse_df)
identical
identical(readRDS("SRP010068_ALL_db_180226_181202.Rda"), readRDS("SRP010068_ALL_db_180226_181541.Rda"))
identical(readRDS("SRP010068_ALL_db_180226_181202.Rda"), readRDS("SRP010068_ALL_db_180226_182259.Rda"))
identical(readRDS("SRP010068_ALL_db_180226_181202.Rda"), readRDS("SRP010068_ALL_db_180226_182404.Rda"))
identical(readRDS("SRP010068_ALL_db_180226_181202.Rda"), readRDS("SRP010068_ALL_db_180226_182950.Rda"))
identical(readRDS("SRP010068_ALL_db_180226_181202.Rda"), readRDS("SRP010068_ALL_db_180226_182950.Rda"))
identical(readRDS("SRP010068_ALL_sm_180226_181202.Rda"), readRDS("SRP010068_ALL_db_180226_182950.Rda"))
identical(readRDS("SRP010068_ALL_sm_180226_181202.Rda"), readRDS("SRP010068_ALL_sm_180226_182950.Rda"))
convertAccession("SRP010068")
convertAccession(c("SRP010068", "SRP020088"))
searchForAccession(c("SRP010068", "SRP020088"))
naConverter
devtools::load_all()
searchForAccession(c("SRP010068", "SRP020088"))
devtools::load_all()
searchForAccession(c("SRP010068", "SRP020088"))
devtools::load_all()
searchForAccession(c("SRP010068", "SRP020088"))
devtools::load_all()
convertAccession(c("SRP010068", "SRP020088"))
searchForAccession(c("SRP010068", "SRP020088"))
devtools::load_all()
searchForAccession(c("SRP010068", "SRP020088"))
temp2 <- searchForAccession(c("SRP010068", "SRP020088"))
View(temp2)
x2 <- data.frame(c(1,2,3), c("a", "b", "c"))
x2
x2 <- data.frame(k=c(1,2,3), l=c("a", "b", "c"))
x2
y2 <- data.frame(l=c("a", "b"), m=c("i", "ii"))
y2
merge(x2, y2)
merge(x2, y2, by.x2=l, by.y2=l, all = TRUE
)
x2 <- data.frame(k=c(1,2,3), l=c("a", "b", "c"))
x2 <- data.frame(k=c(1,2,3), l=c("a", "b", "c"))
x2
y2 <- data.frame(l=c("a", "b"), m=c("i", "ii"))
y2
merge(x2, y2)
merge(x2, y2, all = TRUE)
merge(x2, y2, by.x2=l, by.y2=l, all = TRUE)
x_sra <- data.frame(srr=c("a", "b", "c"), c1 = c(1,2,3), c2 = c(2,4,6))
x_sra
y_srr_gsm <- data.frame(srr=c("a", "b"), gsm=c("i", "ii"))
y_srr_gsm
z_geo <- data.frame(gsm=c("i", "ii"), c3=c(4,8,12), c4=c("s", "s", "s"))
x_sra <- data.frame(srr=c("a", "b", "c"), c1 = c(1,2,3), c2 = c(2,4,6))
x_sra
y_srr_gsm <- data.frame(srr=c("a", "b"), gsm=c("i", "ii"))
y_srr_gsm
z_geo <- data.frame(gsm=c("i", "ii"), c3=c(4,8), c4=c("s", "s"))
z_geo
merge(x_sra, y_srr_gsm)
merge(x_sra_y_srr_gsm, z_geo)
x_sra_y_srr_gsm <- merge(x_sra, y_srr_gsm, all = TRUE)
x_sra_y_srr_gsm <- merge(x_sra, y_srr_gsm, all = TRUE)
x_sra_y_srr_gsm
merge(x_sra_y_srr_gsm, z_geo)
merge(x_sra_y_srr_gsm, z_geo, all = TRUE)
devtools::load_all()
temp2 <- searchForAccession(c("SRP010068", "SRP020088"))
View(temp2)
rm(sra_srr_gsm_df_temp)
rm(srr_gsm_df_temp)
rm(geo_df_temp)
rm(sra_df_temp)
rm(sra_srr_gsm_geo_df_temp)
devtools::load_all()
temp2 <- searchForAccession(c("SRP010068", "SRP020088"))
View(temp_sra_df)
View(temp_geo_df)
View(temp_srr_gsm_df)
View(temp_sra_srr_gsm_df)
View(temp_sra_srr_gsm_geo_df)
colnames(sra_df)
colnames(temp_sra_df)
colnames(temp_geo_df)
View(temp_geo_df)
View(temp_srr_gsm_df)
View(temp_sra_srr_gsm_df)
colnames(temp_sra_srr_gsm_df)
temp2b <- merge(temp_sra_srr_gsm_df, temp_geo_df, by.x = "gsm", by.y = "gsm")
dim(temp2b)
dim(temp_sra_srr_gsm_geo_df)
setdiff(colnames(temp2b),colnames(temp_sra_srr_gsm_geo_df))
temp2b <- merge(temp_sra_srr_gsm_df, temp_geo_df, by.x = "gsm", by.y = "gsm", all.x = TRUE)
dim(temp2b)
View(temp2b)
devtools::load_all()
temp2 <- searchForAccession(c("SRP010068", "SRP020088"))
dim(temp2)
?merge
devtools::load_all()
temp2 <- searchForAccession(c("SRP010068", "SRP020088"))
dim(temp2)
dim(temp_sra_df)
dim(temp_srr_gsm_df)
dim(temp_srr_gsm_geo_df)
dim(temp_geo_df)
temp_sra_srr_gsm_geo_colnames <- c(colnames(temp_sra_df), colnames(temp_srr_gsm_df), colnames(temp_geo_df))
temp_sra_srr_gsm_geo_colnames
setdiff(colnames(temp2), temp_sra_srr_gsm_geo_colnames)
orderAccessions(c("SRR11", "SRR4", "SRR2", "SRR5"))
orderAccessions(c("SRR11", "SRR4", "SRR2", "SRR5", "NA"))
orderAccessions(c("SRR11", "SRR4", "SRR2", "SRR5", "NA"), na.last = FALSE)
getAnywhere(naConverter)
naConverter(c("SRR11", "SRR4", "SRR2", "SRR5", "NA"))
orderAccessions(naConverter(c("SRR11", "SRR4", "SRR2", "SRR5", "NA")))
orderAccessions(naConverter(c("SRR11", "SRR4", "SRR2", "SRR5", "NA")), na.last = FALSE)
which(is.na(c("SRR11", "SRR4", "SRR2", "SRR5", "NA")))
which(is.na(c("SRR11", "SRR4", "SRR2", "SRR5", NA)))
orderAccessions(c("3", NA, "2", "1", NA))
order(c(1,2,3))
order(c(1,2,1))
devtools::load_all()
orderAccessions(c("3", NA, "2", "1", NA))
orderAccessions(c("3", NA, "2", "1..", NA))
order(c("3", NA, "2", "1..", NA))
sort(c("3", NA, "2", "1..", NA))
?sort
sort(c("3", NA, "2", "1..", NA), na.last = TRUE)
sort(c("3", NA, "2", "b1..", NA), na.last = TRUE)
devtools::load_all()
orderAccessions(c("3", NA, "2", "1..", NA))
devtools::test()
orderAccessions(c("c1", "b2"))
orderAccessions(c("c1", "b2", NA))
orderAccessions(c("c1", "b2", NA, "1ll"))
orderAccessions(c("c1", "b2", NA, "1.."))
gsub("[[:alpha:]]", "", "1...")
devtools::load_all()
orderAccessions(c("c1", "b2", NA, "1.."))
getAnywhere(orderAccessions())
getAnywhere(.globalEnv$orderAccessions())
search()
getAnywhere(.GlobalEnv$orderAccessions())
getAnywhere(orderAccessions())
[]
getAnywhere(.GlobalEnv::orderAccessions)
getAnywhere(orderAccessions)[1]
rm(orderAccessions)
getAnywhere(superseriesVerifier())
getAnywhere(superseriesVerifier())[1]
getAnywhere(superseriesVerifier())[]
getAnywhere(superseriesVerifier())[2]
rm(superseriesVerifier)
devtools::load_all()
orderAccessions(c("c1", "b2", NA, "1.."))
devtools::load_all()
orderAccessions(c("c1", "b2", NA, "1.."))
devtools::load_all()
orderAccessions(c("c1", "b2", NA, "1.."))
devtools::load_all()
orderAccessions(c("c1", "b2", NA, "1.."))
grepl("^[[:alnum:]]*$", "1..")
devtools::load_all()
orderAccessions(c("c1", "b2", NA, "1.."))
devtools::load_all()
orderAccessions(c("c1", "b2", NA, "1.."))
orderAccessions(c("c1", "b2", NA, "c"))
devtools::test
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
getAnywhere(orderAccessions)
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
orderAccessions(c("SRP001", "SRP002", "SRP23", "SRP2500", "SRP87889", "NA", "", NA))
devtools::test()
orderAccessions(c("SRP001", "SRP002", "SRP23", "SRP2500", "SRP87889", "NA", "", NA))
t22 <- c("SRP001", "SRP002", "SRP23", "SRP2500", "SRP87889", "NA", "", NA)
t22[orderAccessions(t22)]
devtools::test()
devtools::test()
t22s <- sample(t22)
t22s[orderAccessions(t22s)]
t22
t22s
t22s <- sample(t22)
t22s[orderAccessions(t22s)]
devtools::test()
devtools::test()
?order
getAnywhere(sort)
getAnywhere(sort)[4]
lsf.str("package:SpideR")
dim(lsf.str("package:SpideR"))
length(lsf.str("package:SpideR"))
class(lsf.str("package:SpideR"))
methods("sort")
methods("order")
.S3PrimitiveGenerics
getAnywhere(order)
getAnywhere(order)[5]
getAnywhere(order)[8]
c3 <- list(x=1:5, y=8:10)
c3
seq_along(c3)
seq_along(c3$x)
c3[1]
class(c3[1])
class(c3[[1]])
c3[[1]]
?order
orderAccessions(c(5,7,1,2))
do.call(order, c(3,5,2,NA), na.last = FALSE)
do.call(order, list(x=c(3,5,2,NA), na.last = FALSE))
?do.call
devtools::test()
devtools::test()
orderAccessions(list(c(5,3,1)))
c3 <- list(a=c(5,3,1,1), b=c(1,2,3,4))
orderAccessions(c3)
devtools::test()
orderAccessions(c3)
devtools::test()
orderAccessions(c3)
c3
order(c3)
c3
?order
do.call(order, c3)
do.call(order, list(c3, na.last = TRUE))
do.call(order, list(x=c3, na.last = TRUE))
sort.list(c3)
do.call(order, c(x=c3, na.last = TRUE))
do.call(order, c(x=c3, na.last = FALSE))
c3 <- list(a=c(5,3,1,1, NA), b=c(1,2,3,4, NA))
do.call(order, c(x=c3, na.last = TRUE))
do.call(order, c(x=c3, na.last = FALSE))
devtools::test()
x1 <- list(a = 1:5, b = c(5,4,3,2,1))
sample(x1)
sample(as.data.frame(x1))
?sample
sample(as.data.frame(x1))
sample(as.data.frame(x1))
do.call(order, list(a = 1:3, b=c(2,2)))
sample_list <- function(x){
i <- seq_along(x[[1]])
i <- sample(i)
for (el in seq_along(x)){
x[[el]] <- x[[el]][i]
}
return(x)
}
sample_list(x1)
sample_list(list(a=1:5, b=1:5))
devtools::test()
devtools::test()
x1 <- list(a = 1:5, b = c(5,4,3,2,1))
sample_list(x1)
orderAccessions(sample_list(x1))
x1[orderAccessions(sample_list(x1))]
devtools::test()
order(c(1,5,3,2))
#x_i <- do.call(order, list(x=t, na.last = na.last)) #t is already a list #Does not work
#x_i <- do.call(order, t) #t is already a list #Minimal version, which does not implement na.last
x_i <- do.call(order, c(x=t, na.last = na.last))
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
devtools::test()
print(c(1,4,3))
cc <- c(1,2,NA)
as.character(cc)
as.numeric(as.character(cc))
devtools::test()
devtools::test()
devtools::test()
c22
c2
devtools::test()
searchForAccession(c("SRP010068", "SRP020088"))
temp3 <- searchForAccession(c("SRP010068", "SRP020088"))
View(temp3)
View(viewSamples_db(temp3))
?order
